<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BIXX CAR - Cadastro de Proprietário</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --primary: #1a73e8;
            --secondary: #fbbc04;
            --dark: #202124;
            --light: #f8f9fa;
            --gray: #5f6368;
            --success: #34a853;
            --error: #ea4335;
        }

        body {
            background-color: #f5f5f5;
        }

        /* Cabeçalho */
        header {
            background-color: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .top-bar {
            background-color: var(--dark);
            color: white;
            padding: 8px 0;
            font-size: 14px;
        }

        .top-bar-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
        }

        .contact-info span {
            margin-right: 20px;
        }

        .contact-info i {
            margin-right: 5px;
            color: var(--secondary);
        }

        .user-actions a {
            color: white;
            text-decoration: none;
            margin-left: 15px;
            transition: color 0.3s;
        }

        .user-actions a:hover {
            color: var(--secondary);
        }

        .main-header {
            max-width: 1200px;
            margin: 0 auto;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
        }

        .logo h1 {
            font-size: 28px;
            color: var(--primary);
            font-weight: 700;
        }

        .logo span {
            color: var(--secondary);
        }

        .header-actions {
            display: flex;
            align-items: center;
        }

        .rent-btn {
            background-color: var(--primary);
            color: white;
            padding: 10px 20px;
            border-radius: 30px;
            font-weight: 600;
            text-decoration: none;
            transition: background 0.3s;
            margin-left: 20px;
        }

        .rent-btn:hover {
            background-color: #0d5bb9;
        }

        /* Menu de Navegação */
        nav {
            background-color: var(--primary);
            padding: 0 20px;
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .nav-menu {
            display: flex;
            list-style: none;
        }

        .nav-menu li {
            position: relative;
        }

        .nav-menu a {
            color: white;
            text-decoration: none;
            padding: 15px 20px;
            display: block;
            font-weight: 500;
            transition: background 0.3s;
        }

        .nav-menu a:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        /* Seção de Cadastro */
        .registration-section {
            max-width: 1000px;
            margin: 40px auto;
            padding: 0 20px;
        }

        .registration-container {
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .registration-header {
            background-color: var(--primary);
            color: white;
            padding: 25px 30px;
        }

        .registration-title {
            font-size: 28px;
            margin-bottom: 10px;
        }

        .registration-subtitle {
            font-size: 16px;
            opacity: 0.9;
        }

        .registration-steps {
            display: flex;
            background-color: #e8f0fe;
            padding: 0 30px;
        }

        .step {
            padding: 15px 0;
            flex: 1;
            text-align: center;
            font-weight: 500;
            position: relative;
            color: var(--gray);
        }

        .step.active {
            color: var(--primary);
            font-weight: 600;
        }

        .step.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background-color: var(--primary);
        }

        .registration-content {
            padding: 30px;
        }

        .step-content {
            display: none;
        }

        .step-content.active {
            display: block;
        }

        .form-title {
            font-size: 22px;
            margin-bottom: 25px;
            color: var(--dark);
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }

        .form-row {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            flex: 1;
            min-width: 250px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--dark);
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            transition: border 0.3s;
        }

        .form-control:focus {
            border-color: var(--primary);
            outline: none;
        }

        .form-select {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            background-color: white;
            cursor: pointer;
        }

        .form-select:focus {
            border-color: var(--primary);
            outline: none;
        }

        .form-textarea {
            min-height: 100px;
            resize: vertical;
        }

        .checkbox-group {
            display: flex;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .checkbox-group input {
            margin-right: 10px;
            margin-top: 5px;
        }

        .checkbox-group label {
            font-weight: normal;
            line-height: 1.5;
        }

        .checkbox-group a {
            color: var(--primary);
            text-decoration: none;
        }

        .checkbox-group a:hover {
            text-decoration: underline;
        }

        .form-actions {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 5px;
            font-weight: 600;
            font-size: 16px;
            cursor: pointer;
            transition: background 0.3s;
        }

        .btn-prev {
            background-color: #f1f1f1;
            color: var(--dark);
        }

        .btn-prev:hover {
            background-color: #e1e1e1;
        }

        .btn-next {
            background-color: var(--primary);
            color: white;
        }

        .btn-next:hover {
            background-color: #0d5bb9;
        }

        .btn-submit {
            background-color: var(--success);
            color: white;
        }

        .btn-submit:hover {
            background-color: #2e8b47;
        }

        .btn-disabled {
            background-color: #ccc;
            color: #666;
            cursor: not-allowed;
        }

        .btn-disabled:hover {
            background-color: #ccc;
        }

        .error-message {
            color: var(--error);
            font-size: 14px;
            margin-top: 5px;
            display: none;
        }

        .success-message {
            color: var(--success);
            font-size: 14px;
            margin-top: 5px;
            display: none;
        }

        .password-strength {
            margin-top: 5px;
            height: 5px;
            border-radius: 5px;
            background-color: #eee;
            overflow: hidden;
        }

        .password-strength-bar {
            height: 100%;
            width: 0;
            transition: width 0.3s, background-color 0.3s;
        }

        .password-weak {
            background-color: var(--error);
            width: 33%;
        }

        .password-medium {
            background-color: var(--secondary);
            width: 66%;
        }

        .password-strong {
            background-color: var(--success);
            width: 100%;
        }

        /* Footer */
        footer {
            background-color: var(--dark);
            color: white;
            padding: 50px 0 20px;
            margin-top: 50px;
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            flex-wrap: wrap;
            gap: 40px;
        }

        .footer-column {
            flex: 1;
            min-width: 200px;
        }

        .footer-column h3 {
            font-size: 20px;
            margin-bottom: 20px;
            color: var(--secondary);
        }

        .footer-links {
            list-style: none;
        }

        .footer-links li {
            margin-bottom: 10px;
        }

        .footer-links a {
            color: #ddd;
            text-decoration: none;
            transition: color 0.3s;
        }

        .footer-links a:hover {
            color: var(--secondary);
        }

        .footer-contact {
            list-style: none;
        }

        .footer-contact li {
            margin-bottom: 15px;
            display: flex;
            align-items: flex-start;
        }

        .footer-contact i {
            color: var(--secondary);
            margin-right: 10px;
            margin-top: 5px;
        }

        .social-icons {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }

        .social-icons a {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            color: white;
            text-decoration: none;
            transition: background 0.3s;
        }

        .social-icons a:hover {
            background-color: var(--primary);
        }

        .footer-bottom {
            max-width: 1200px;
            margin: 40px auto 0;
            padding: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            text-align: center;
            color: #aaa;
            font-size: 14px;
        }

        /* Responsividade */
        @media (max-width: 768px) {
            .top-bar {
                display: none;
            }

            .main-header {
                flex-wrap: wrap;
            }

            .nav-menu {
                flex-wrap: wrap;
            }

            .nav-menu li {
                flex: 1 0 50%;
            }

            .registration-steps {
                flex-direction: column;
            }

            .step {
                text-align: left;
                padding-left: 20px;
            }

            .form-actions {
                flex-direction: column;
                gap: 15px;
            }

            .btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <!-- Cabeçalho -->
    <header>
        <div class="top-bar">
            <div class="top-bar-content">
                <div class="contact-info">
                    <span><i class="fas fa-phone"></i> (11) 4002-8922</span>
                    <span><i class="fas fa-envelope"></i> contato@bixxcar.com</span>
                </div>
                <div class="user-actions">
                    <a href="#"><i class="fas fa-user"></i> Minha Conta</a>
                    <a href="#"><i class="fas fa-question-circle"></i> Ajuda</a>
                </div>
            </div>
        </div>

        <div class="main-header">
            <div class="logo">
                <h1>BIXX <span>CAR</span></h1>
            </div>

            <div class="header-actions">
                <a href="https://bixx.com.br" class="rent-btn">
                    <i class="fas fa-home"></i> Voltar para o Início
                </a>
            </div>
        </div>

        <nav>
            <div class="nav-container">
                <ul class="nav-menu">
                    <li><a href="index.html">Início</a></li>
                    <li><a href="#">Alugar Carro</a></li>
                    <li><a href="#">Como Funciona</a></li>
                    <li><a href="#" class="active">Para Proprietários</a></li>
                    <li><a href="#">Promoções</a></li>
                    <li><a href="#">Avaliações</a></li>
                    <li><a href="#">Contato</a></li>
                </ul>
            </div>
        </nav>
    </header>

    <!-- Seção de Cadastro -->
    <section class="registration-section">
        <div class="registration-container">
            <div class="registration-header">
                <h2 class="registration-title">Cadastro de Proprietário</h2>
                <p class="registration-subtitle">Preencha as informações abaixo para se cadastrar como proprietário na plataforma BIXX CAR</p>
            </div>

            <div class="registration-steps">
                <div class="step active" data-step="1">1. Dados Pessoais</div>
                <div class="step" data-step="2">2. Termos e Condições</div>
                <div class="step" data-step="3">3. Finalizar</div>
            </div>

            <div class="registration-content">
                <!-- Passo 1: Dados Pessoais -->
                <div class="step-content active" id="step-1">
                    <h3 class="form-title">Dados Pessoais</h3>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="full-name">Nome Completo *</label>
                            <input type="text" id="full-name" class="form-control" placeholder="Seu nome completo">
                            <div class="error-message" id="name-error">Por favor, informe seu nome completo</div>
                        </div>
                        <div class="form-group">
                            <label for="cpf">CPF *</label>
                            <input type="text" id="cpf" class="form-control" placeholder="000.000.000-00">
                            <div class="error-message" id="cpf-error">CPF inválido</div>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="email">E-mail *</label>
                            <input type="email" id="email" class="form-control" placeholder="seu@email.com">
                            <div class="error-message" id="email-error">E-mail inválido</div>
                        </div>
                        <div class="form-group">
                            <label for="phone">Telefone *</label>
                            <input type="text" id="phone" class="form-control" placeholder="(11) 99999-9999">
                            <div class="error-message" id="phone-error">Telefone inválido</div>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="password">Senha *</label>
                            <input type="password" id="password" class="form-control" placeholder="Mínimo 6 caracteres">
                            <div class="password-strength">
                                <div class="password-strength-bar" id="password-strength-bar"></div>
                            </div>
                            <div class="error-message" id="password-error">A senha deve ter pelo menos 6 caracteres</div>
                        </div>
                        <div class="form-group">
                            <label for="confirm-password">Confirmar Senha *</label>
                            <input type="password" id="confirm-password" class="form-control" placeholder="Digite novamente sua senha">
                            <div class="error-message" id="confirm-password-error">As senhas não coincidem</div>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button class="btn btn-prev" disabled>Anterior</button>
                        <button class="btn btn-next" id="step-1-next">Próximo</button>
                    </div>
                </div>

                <!-- Passo 2: Termos e Condições -->
                <div class="step-content" id="step-2">
                    <h3 class="form-title">Termos e Condições</h3>

                    <div class="checkbox-group">
                        <input type="checkbox" id="terms-accept">
                        <label for="terms-accept">Li e concordo com os <a href="#">Termos de Uso</a> e <a href="#">Política de Privacidade</a> da BIXX CAR *</label>
                    </div>
                    <div class="error-message" id="terms-error">Você precisa aceitar os termos e condições</div>

                    <div class="form-actions">
                        <button class="btn btn-prev" id="step-2-prev">Anterior</button>
                        <button class="btn btn-next" id="step-2-next">Finalizar Cadastro</button>
                    </div>
                </div>

                <!-- Passo 3: Finalizar -->
                <div class="step-content" id="step-3">
                    <h3 class="form-title">Finalizar Cadastro</h3>

                    <div style="text-align: center; padding: 20px;">
                        <i class="fas fa-check-circle" style="font-size: 60px; color: var(--success); margin-bottom: 20px;"></i>
                        <h3 style="margin-bottom: 15px;" id="success-title">Processando cadastro...</h3>
                        <p style="margin-bottom: 30px; color: var(--gray);" id="success-message">Aguarde enquanto processamos suas informações.</p>

                        <div id="success-details" style="display: none;">
                            <div style="background-color: #e8f0fe; padding: 20px; border-radius: 10px; text-align: left; margin-bottom: 30px;">
                                <h4 style="margin-bottom: 15px; color: var(--primary);">Próximos Passos:</h4>
                                <ul style="list-style-type: none;">
                                    <li style="margin-bottom: 10px;"><i class="fas fa-check" style="color: var(--success); margin-right: 10px;"></i> Validação dos dados enviados</li>
                                    <li style="margin-bottom: 10px;"><i class="fas fa-check" style="color: var(--success); margin-right: 10px;"></i> Entraremos em contato por e-mail para solicitar as documentações necessárias</li>
                                    <li style="margin-bottom: 10px;"><i class="fas fa-check" style="color: var(--success); margin-right: 10px;"></i> Após aprovação, você poderá cadastrar seus veículos na plataforma</li>
                                </ul>
                            </div>

                            <button class="btn btn-submit" id="go-to-dashboard">Acessar Painel de Controle</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="footer-content">
            <div class="footer-column">
                <h3>BIXX CAR</h3>
                <p>A plataforma de aluguel de carros P2P que conecta proprietários e locatários de forma segura e conveniente.</p>
                <div class="social-icons">
                    <a href="#"><i class="fab fa-facebook-f"></i></a>
                    <a href="#"><i class="fab fa-instagram"></i></a>
                    <a href="#"><i class="fab fa-twitter"></i></a>
                    <a href="#"><i class="fab fa-linkedin-in"></i></a>
                </div>
            </div>

            <div class="footer-column">
                <h3>Links Rápidos</h3>
                <ul class="footer-links">
                    <li><a href="index.html">Início</a></li>
                    <li><a href="#">Alugar Carro</a></li>
                    <li><a href="#">Anunciar Carro</a></li>
                    <li><a href="#">Como Funciona</a></li>
                    <li><a href="#">Promoções</a></li>
                </ul>
            </div>

            <div class="footer-column">
                <h3>Para Proprietários</h3>
                <ul class="footer-links">
                    <li><a href="#">Cadastrar Veículo</a></li>
                    <li><a href="#">Calculadora de Lucros</a></li>
                    <li><a href="#">Seguro Parceiro</a></li>
                    <li><a href="#">Dicas de Sucesso</a></li>
                    <li><a href="#">Central do Proprietário</a></li>
                </ul>
            </div>

            <div class="footer-column">
                <h3>Contato</h3>
                <ul class="footer-contact">
                    <li>
                        <i class="fas fa-map-marker-alt"></i>
                        <span>Av. Paulista, 1000 - São Paulo, SP</span>
                    </li>
                    <li>
                        <i class="fas fa-phone"></i>
                        <span>(11) 4002-8922</span>
                    </li>
                    <li>
                        <i class="fas fa-envelope"></i>
                        <span>contato@bixxcar.com</span>
                    </li>
                    <li>
                        <i class="fas fa-clock"></i>
                        <span>Segunda a Sexta: 8h às 18h</span>
                    </li>
                </ul>
            </div>
        </div>

        <div class="footer-bottom">
            <p>&copy; 2023 BIXX CAR - Aluguel de Carros P2P. Todos os direitos reservados.</p>
        </div>
    </footer>

    <script>
        // Configuração do Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyCViJaATK6A-5fTJSGBV9j9LSjTFYUDK64",
            authDomain: "bixx-car.firebaseapp.com",
            projectId: "bixx-car",
            storageBucket: "bixx-car.firebasestorage.app",
            messagingSenderId: "785931877829",
            appId: "1:785931877829:web:b1fc9a5f14dbfccf5edfac"
        };

        // Inicializar Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        // Variáveis globais
        let currentStep = 1;
        const totalSteps = 3;

        // Elementos DOM
        const steps = document.querySelectorAll('.step');
        const stepContents = document.querySelectorAll('.step-content');
        const nextButtons = document.querySelectorAll('.btn-next');
        const prevButtons = document.querySelectorAll('.btn-prev');
        const goToDashboardBtn = document.getElementById('go-to-dashboard');
        const successTitle = document.getElementById('success-title');
        const successMessage = document.getElementById('success-message');
        const successDetails = document.getElementById('success-details');

        // Event Listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Navegação entre passos
            nextButtons.forEach(button => {
                button.addEventListener('click', handleNextStep);
            });

            prevButtons.forEach(button => {
                button.addEventListener('click', handlePrevStep);
            });

            // Validação de senha
            const passwordInput = document.getElementById('password');
            passwordInput.addEventListener('input', checkPasswordStrength);

            // Validação de confirmação de senha
            const confirmPasswordInput = document.getElementById('confirm-password');
            confirmPasswordInput.addEventListener('input', validatePasswordMatch);

            // Botão para ir ao dashboard
            goToDashboardBtn.addEventListener('click', function() {
                window.location.href = 'dashboard.html';
            });

            // Formatação de CPF
            const cpfInput = document.getElementById('cpf');
            cpfInput.addEventListener('input', formatCPF);

            // Formatação de telefone
            const phoneInput = document.getElementById('phone');
            phoneInput.addEventListener('input', formatPhone);
        });

        // Funções de navegação
        function handleNextStep(e) {
            e.preventDefault();

            // Validar passo atual antes de avançar
            if (validateStep(currentStep)) {
                if (currentStep < totalSteps) {
                    // Se estamos no passo 2, criar a conta no Firebase
                    if (currentStep === 2) {
                        createAccount();
                    } else {
                        // Avançar para o próximo passo
                        currentStep++;
                        updateStepDisplay();
                    }
                }
            }
        }

        function handlePrevStep(e) {
            e.preventDefault();

            if (currentStep > 1) {
                currentStep--;
                updateStepDisplay();
            }
        }

        function updateStepDisplay() {
            // Atualizar indicadores de passo
            steps.forEach(step => {
                const stepNumber = parseInt(step.getAttribute('data-step'));
                if (stepNumber === currentStep) {
                    step.classList.add('active');
                } else {
                    step.classList.remove('active');
                }
            });

            // Atualizar conteúdo dos passos
            stepContents.forEach(content => {
                const contentId = content.id;
                const contentStep = parseInt(contentId.split('-')[1]);

                if (contentStep === currentStep) {
                    content.classList.add('active');
                } else {
                    content.classList.remove('active');
                }
            });
        }

        // Funções de validação
        function validateStep(step) {
            let isValid = true;

            switch(step) {
                case 1:
                    isValid = validateStep1();
                    break;
                case 2:
                    isValid = validateStep2();
                    break;
            }

            return isValid;
        }

        function validateStep1() {
            let isValid = true;

            // Validar nome
            const name = document.getElementById('full-name').value.trim();
            if (name === '') {
                showError('name-error');
                isValid = false;
            } else {
                hideError('name-error');
            }

            // Validar CPF
            const cpf = document.getElementById('cpf').value;
            if (!isValidCPF(cpf)) {
                showError('cpf-error');
                isValid = false;
            } else {
                hideError('cpf-error');
            }

            // Validar e-mail
            const email = document.getElementById('email').value;
            if (!isValidEmail(email)) {
                showError('email-error');
                isValid = false;
            } else {
                hideError('email-error');
            }

            // Validar telefone
            const phone = document.getElementById('phone').value;
            if (!isValidPhone(phone)) {
                showError('phone-error');
                isValid = false;
            } else {
                hideError('phone-error');
            }

            // Validar senha
            const password = document.getElementById('password').value;
            if (password.length < 6) {
                showError('password-error');
                isValid = false;
            } else {
                hideError('password-error');
            }

            // Validar confirmação de senha
            const confirmPassword = document.getElementById('confirm-password').value;
            if (password !== confirmPassword) {
                showError('confirm-password-error');
                isValid = false;
            } else {
                hideError('confirm-password-error');
            }

            return isValid;
        }

        function validateStep2() {
            let isValid = true;

            // Validar termos
            const termsAccepted = document.getElementById('terms-accept').checked;
            if (!termsAccepted) {
                showError('terms-error');
                isValid = false;
            } else {
                hideError('terms-error');
            }

            return isValid;
        }

        // Funções auxiliares de validação
        function isValidEmail(email) {
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return emailRegex.test(email);
        }

        function isValidCPF(cpf) {
            // Remover caracteres não numéricos
            cpf = cpf.replace(/\D/g, '');

            // Verificar se tem 11 dígitos
            if (cpf.length !== 11) return false;

            // Verificar se todos os dígitos são iguais
            if (/^(\d)\1+$/.test(cpf)) return false;

            // Validar dígitos verificadores
            let sum = 0;
            let remainder;

            for (let i = 1; i <= 9; i++) {
                sum += parseInt(cpf.substring(i-1, i)) * (11 - i);
            }

            remainder = (sum * 10) % 11;
            if (remainder === 10 || remainder === 11) remainder = 0;
            if (remainder !== parseInt(cpf.substring(9, 10))) return false;

            sum = 0;
            for (let i = 1; i <= 10; i++) {
                sum += parseInt(cpf.substring(i-1, i)) * (12 - i);
            }

            remainder = (sum * 10) % 11;
            if (remainder === 10 || remainder === 11) remainder = 0;
            if (remainder !== parseInt(cpf.substring(10, 11))) return false;

            return true;
        }

        function isValidPhone(phone) {
            // Remover caracteres não numéricos
            phone = phone.replace(/\D/g, '');

            // Verificar se tem 10 ou 11 dígitos (com DDD)
            return phone.length === 10 || phone.length === 11;
        }

        function checkPasswordStrength() {
            const password = document.getElementById('password').value;
            const strengthBar = document.getElementById('password-strength-bar');

            // Resetar a barra
            strengthBar.className = 'password-strength-bar';

            if (password.length === 0) {
                return;
            }

            // Calcular força da senha
            let strength = 0;

            // Comprimento mínimo
            if (password.length >= 6) strength++;

            // Contém letras minúsculas e maiúsculas
            if (/[a-z]/.test(password) && /[A-Z]/.test(password)) strength++;

            // Contém números
            if (/[0-9]/.test(password)) strength++;

            // Contém caracteres especiais
            if (/[^A-Za-z0-9]/.test(password)) strength++;

            // Atualizar a barra de força
            if (strength <= 1) {
                strengthBar.classList.add('password-weak');
            } else if (strength === 2) {
                strengthBar.classList.add('password-medium');
            } else {
                strengthBar.classList.add('password-strong');
            }
        }

        function validatePasswordMatch() {
            const password = document.getElementById('password').value;
            const confirmPassword = document.getElementById('confirm-password').value;

            if (confirmPassword.length > 0 && password !== confirmPassword) {
                showError('confirm-password-error');
            } else {
                hideError('confirm-password-error');
            }
        }

        // Funções de formatação
        function formatCPF(e) {
            let value = e.target.value.replace(/\D/g, '');

            if (value.length <= 11) {
                value = value.replace(/(\d{3})(\d)/, '$1.$2');
                value = value.replace(/(\d{3})(\d)/, '$1.$2');
                value = value.replace(/(\d{3})(\d{1,2})$/, '$1-$2');
            }

            e.target.value = value;
        }

        function formatPhone(e) {
            let value = e.target.value.replace(/\D/g, '');

            if (value.length <= 11) {
                value = value.replace(/(\d{2})(\d)/, '($1) $2');
                value = value.replace(/(\d{5})(\d)/, '$1-$2');
            }

            e.target.value = value;
        }

        // Funções de exibição de erro
        function showError(errorId) {
            document.getElementById(errorId).style.display = 'block';
        }

        function hideError(errorId) {
            document.getElementById(errorId).style.display = 'none';
        }

        // Função para criar conta no Firebase
        function createAccount() {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;

            // Mostrar mensagem de processamento
            successTitle.textContent = "Processando cadastro...";
            successMessage.textContent = "Aguarde enquanto processamos suas informações.";
            successDetails.style.display = "none";

            // Avançar para o passo 3
            currentStep++;
            updateStepDisplay();

            auth.createUserWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    // Conta criada com sucesso
                    const user = userCredential.user;
                    console.log('Usuário criado:', user);

                    // Salvar dados no Firestore usando o userId como nome do documento
                    saveUserData(user.uid)
                        .then(() => {
                            // Atualizar mensagem de sucesso
                            successTitle.textContent = "Cadastro Bem-Sucedido!";
                            successMessage.textContent = "Seu cadastro foi realizado com sucesso. Entraremos em contato pelo e-mail informado para solicitar as documentações necessárias para finalizar o cadastro.";
                            successDetails.style.display = "block";
                        })
                        .catch((error) => {
                            console.error('Erro ao salvar dados:', error);
                            successTitle.textContent = "Cadastro Parcialmente Concluído";
                            successMessage.textContent = "Seu cadastro foi criado, mas houve um problema ao salvar algumas informações. Entre em contato com nosso suporte.";
                            successDetails.style.display = "block";
                        });
                })
                .catch((error) => {
                    // Tratar erros
                    const errorCode = error.code;
                    const errorMessage = error.message;
                    console.error('Erro ao criar conta:', errorCode, errorMessage);

                    // Voltar para o passo 2 em caso de erro
                    currentStep = 2;
                    updateStepDisplay();

                    // Exibir mensagem de erro
                    if (errorCode === 'auth/email-already-in-use') {
                        showError('email-error');
                        document.getElementById('email-error').textContent = 'Este e-mail já está em uso';
                    } else {
                        alert('Erro ao criar conta: ' + errorMessage);
                    }
                });
        }

        // Função para salvar dados no Firestore
        function saveUserData(userId) {
            // Coletar dados do formulário
            const userData = {
                fullName: document.getElementById('full-name').value.trim(),
                cpf: document.getElementById('cpf').value.replace(/\D/g, ''),
                email: document.getElementById('email').value,
                phone: document.getElementById('phone').value.replace(/\D/g, ''),
                termsAccepted: document.getElementById('terms-accept').checked,
                registrationDate: new Date(),
                status: 'pending_documents',
                userType: 'proprietario',
                userId: userId
            };

            // Salvar dados na coleção 'proprietarios' usando userId como ID do documento
            return db.collection('proprietarios').doc(userId).set(userData);
        }
    </script>
</body>
</html>
